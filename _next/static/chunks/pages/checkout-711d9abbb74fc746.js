(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[222],{7250:function(e,t,l){(window.__NEXT_P=window.__NEXT_P||[]).push(["/checkout",function(){return l(6061)}])},6061:function(e,t,l){"use strict";let s;l.r(t),l.d(t,{default:function(){return Z}});var a=l(5893),i=l(220),r=l(9417),n=l(9603),d=l(1548),o=l(5675),c=l.n(o),u=l(9361);let m={counterButton:"h-8 w-8 inline-flex justify-center items-center mx-1"},p=e=>{let{data:t}=e,{updateQuantity:l,removeItem:s}=(0,d.i)();return(0,a.jsx)("div",{className:"px-3 py-5 bg-[#F9FAFB]",children:(0,a.jsxs)("div",{className:"flex items-center -m-2",children:[(0,a.jsx)("div",{className:"p-2 sm:mr-4 lg:mr-6",children:(0,a.jsx)("div",{className:"h-[72px] w-[96px] relative flex-shrink-0",children:(0,a.jsx)(c(),{src:(null==t?void 0:t.image)?(0,u.Jn)(t.image):"/img/checkout/img1.jpg",alt:t.name,fill:!0,className:"object-cover"})})}),(0,a.jsxs)("div",{className:"flex flex-wrap items-center flex-grow p-2 sm:flex-nowrap w-min",children:[(0,a.jsxs)("div",{className:"flex-grow mb-4 sm:mb-0",children:[(0,a.jsx)("h5",{className:"mb-2 font-normal lowercase",children:t.name}),(0,a.jsx)("p",{className:"text-lg font-normal",children:Number(t.price).toFixed(2)})]}),(0,a.jsxs)("div",{className:"flex sm:flex-wrap justify-between sm:justify-end w-full sm:w-[inherit]",children:[(0,a.jsx)("div",{className:"order-2 sm:mb-6 sm:order-1",children:(0,a.jsx)(n.G,{className:"text-xl cursor-pointer",icon:r.Vui,onClick:()=>s(t)})}),(0,a.jsx)("div",{className:"order-1 sm:w-full sm:order-2",children:(0,a.jsxs)("ul",{className:"flex justify-end -mx-1",children:[(0,a.jsx)("li",{onClick:()=>l(!0,t),children:(0,a.jsx)("button",{className:"".concat(m.counterButton," bg-white cursor-pointer text-2xl"),type:"button",children:"+"})}),(0,a.jsx)("li",{className:"".concat(m.counterButton," bg-primary text-white text-base rounded-md"),children:t.quantity}),(0,a.jsx)("li",{onClick:()=>l(!1,t),children:(0,a.jsx)("button",{className:"".concat(m.counterButton," bg-white cursor-pointer text-2xl"),type:"button",children:"-"})})]})})]})]})]})})},h={input:"bg-transparent rounded-full border-primary border w-full text-primary placeholder:text-primary px-4 md:px-6 text-lg md:text-2xl font-normal focus:ring-0 focus:outline-none",paymentDetailsWrapper:"flex justify-between lowercase mb-2.5 text-xl"},x=e=>{var t,l,s,i;let{data:r}=e,n=(null==r?void 0:r.reduce((e,t)=>e+t.price*t.quantity,0))||0;return(0,a.jsxs)("div",{className:"p-4 bg-white border md:p-8 rounded-2xl border-primary-light",children:[(0,a.jsx)("h5",{className:"mb-8 lowercase",children:"Order Summary"}),null==r?void 0:r.map(e=>(0,a.jsx)("div",{className:"mb-4",children:(0,a.jsx)(p,{data:e})},e.id)),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"".concat(h.paymentDetailsWrapper),children:[(0,a.jsx)("div",{children:"Sub total"}),(0,a.jsxs)("div",{className:"text-right",children:["$",null===(t=parseFloat(n))||void 0===t?void 0:t.toFixed(2)]})]}),(0,a.jsxs)("div",{className:"".concat(null==h?void 0:h.paymentDetailsWrapper),children:[(0,a.jsx)("div",{children:"Tax"}),(0,a.jsxs)("div",{className:"text-right",children:["$",null===(l=parseFloat(0))||void 0===l?void 0:l.toFixed(2)]})]}),(0,a.jsxs)("div",{className:"".concat(h.paymentDetailsWrapper),children:[(0,a.jsx)("div",{children:"Shipping"}),(0,a.jsxs)("div",{className:"text-right",children:["$",null===(s=parseFloat(0))||void 0===s?void 0:s.toFixed(2)]})]}),(0,a.jsxs)("div",{className:"".concat(h.paymentDetailsWrapper," mb-0"),children:[(0,a.jsx)("div",{children:"Total"}),(0,a.jsxs)("div",{className:"text-right",children:["$",null===(i=parseFloat(n+0+0))||void 0===i?void 0:i.toFixed(2)]})]})]})]})};var v=l(1163),f=l(7294),y=l(8767),g=l(7703),w=l(4928),j=l(1664),b=l.n(j),N=l(7536);let _={input:"bg-transparent rounded-md border-primary border w-full text-primary placeholder:text-primary px-4 md:px-6 text-lg md:text-xl font-normal focus:ring-0 focus:outline-none"},S=e=>{let{onUpdateUserEmail:t,email:l}=e,[s,i]=(0,f.useState)("edit"),{register:r,handleSubmit:n}=(0,N.cI)({defaultValues:{email:l}});(0,f.useEffect)(()=>{l&&l.length>0?i("show"):i("edit")},[l]);let d=e=>{t(e),i("show")};return(0,a.jsxs)("div",{className:"p-4 bg-white border border-primary-light md:p-8 md:pb-10 rounded-2xl",children:[(0,a.jsxs)("div",{className:"flex justify-between mb-4",children:[(0,a.jsx)("h5",{className:"lowercase",children:"your email*"}),"edit"!==s?(0,a.jsx)("p",{className:"font-normal cursor-pointer",onClick:()=>i("edit"),children:"edit"}):""]}),"edit"===s?(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"mb-6 text-xl font-normal leading-8 lowercase",children:["You'll receive receipts and notifications at this email address.",(0,a.jsx)("br",{}),"Already have an account?"," ",(0,a.jsx)(b(),{href:"/login?redirect=checkout",className:"text-secondary-dark",children:"Sign in"})]}),(0,a.jsxs)("form",{onSubmit:n(d),children:[(0,a.jsx)("div",{className:"mb-4 text-center",children:(0,a.jsx)("input",{placeholder:"your email",type:"email",defaultValue:l,className:"".concat(_.input,"  h-10 md:h-14"),...r("email",{required:"email is required!",pattern:{value:u.HN,message:"please add a valid email address."}})})}),(0,a.jsx)(w.Z,{type:"submit",className:"w-full lowercase",size:"sm",children:"Continue"})]})]}):(0,a.jsx)("p",{className:"mt-2 font-normal lowercase",children:l})]})};var k=l(6501),C=l(5598),q=l(1291);let E=()=>(s||(s=(0,q.J)("pk_test_EuzVCt1izWSKZydysclYyRJw")),s);var P=l(6664);let z=e=>{let{amount:t,disabled:l}=e,s=(0,P.useStripe)(),[i,r]=(0,f.useState)(null),[n,d]=(0,f.useState)(!1),[o,c]=(0,f.useState)(!1),u=(0,f.useCallback)(async e=>{let l=await fetch("".concat("https://jules-backend.dev.spacecats.tech/api/v1/","applepay"),{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({paymentDetails:{currency:"usd",amount:t}})}).then(e=>e.json());if(l.error)console.log(l.error),e.complete("fail");else{e.complete("success");let{error:a,paymentIntent:i}=await s.confirmCardPayment(l.data.intent.client_secret);if(a){console.log(a);return}"succeeded"===i.status?(console.log("Payment succeeded!"),k.Am.success("Payment succeeded!",{position:"top-right"})):(console.warn("Unexpected status: ".concat(i.status," for ").concat(i)),k.Am.error("Payment failed",{position:"top-right"}))}},[t,s]);return((0,f.useEffect)(()=>{if(s){let e=s.paymentRequest({country:"US",currency:"usd",total:{label:"Total",amount:t},requestPayerName:!0,requestPayerEmail:!0});e.canMakePayment().then(t=>{t?(c(!0),(null==t?void 0:t.applePay)?d(!0):d(!1),e.on("paymentmethod",u),r(e)):c(!1)})}},[t,u,i,s]),i)?(0,a.jsx)(a.Fragment,{children:o&&(0,a.jsx)(w.Z,{type:"button",id:"payment-request-button",className:"w-full lowercase btn btn-primary",size:"sm",onClick:()=>i.show(),disabled:l,children:n?"Pay with Apple":"Pay with Link"})}):null},D=e=>{let{data:t,onUpdateUserEmail:l,step:s}=e,i=(0,v.useRouter)(),[r,n]=(0,f.useState)("edit"),{cart:o}=(0,d.i)(),{data:c}=(0,y.useQuery)("api/customer/profile",g.TW),[u,m]=(0,f.useState)(!1),[p,h]=(0,f.useState)(!1),x=(null==o?void 0:o.filter(e=>e.isSelected).reduce((e,t)=>e+Number(t.quantity)*Number(t.variant.price||0),0))||0;(0,f.useEffect)(()=>{(null==t?void 0:t.payment)?n("show"):n("edit")},[null==t?void 0:t.payment]);let j=async e=>{var t,l,s,a,r,n;e.preventDefault(),h(!0);{let d=JSON.parse(window.localStorage.getItem("userData"));localStorage.setItem("paypalOrderPlaceItems",JSON.stringify({fname:(null==d?void 0:null===(l=d.address)||void 0===l?void 0:l.name)||"",email:(null==d?void 0:d.email)||"",phone:(null==d?void 0:null===(s=d.address)||void 0===s?void 0:s.phone)||"",address1:(null==d?void 0:null===(a=d.address)||void 0===a?void 0:a.address)||"",city:(null==d?void 0:null===(r=d.address)||void 0===r?void 0:r.city)||"",state:(null==c?void 0:c.state)||"",country:(null==c?void 0:c.country)||"",postcode:null==d?void 0:d.address.zip,payment_status:2,orderedItems:null===(n=null==o?void 0:o.filter(e=>e.isSelected))||void 0===n?void 0:n.map(e=>({product_model_id:e.id,qty:e.quantity,attribute_value_id:e.variant.attribute_value_id}))}))}let u=await (0,C.ak)(x+0);(null==u?void 0:null===(t=u.data)||void 0===t?void 0:t.status)&&(i.push(u.data.link),h(!1))},b=e=>{e.preventDefault(),m(!0),(0,C.hp)(o.filter(e=>e.isSelected).map(e=>({product_id:e.id,attribute_id:e.variant.attribute_value[0].attribute_id,attribute_value_id:e.variant.attribute_value_id,qty:e.quantity}))).then(async()=>{var e,l;window.localStorage.setItem("userData",JSON.stringify(t));let s=await (0,C.Jh)(x+0);(null==s?void 0:null===(e=s.data)||void 0===e?void 0:e.status)?(i.push(s.data.url),m(!1)):(console.warn(null==s?void 0:null===(l=s.data)||void 0===l?void 0:l.message),m(!1)),m(!1)}).catch(e=>{m(!1),k.Am.error(null==e?void 0:e.message,{position:"top-right"})})};return(0,a.jsxs)("div",{className:"p-4 bg-white border border-primary-light md:p-8 md:py-10 rounded-2xl",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("h5",{className:"lowercase",children:"Make Payment*"}),"edit"!==r?(0,a.jsx)("p",{className:"font-normal cursor-pointer",onClick:()=>n("edit"),children:"edit"}):""]}),3===s?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("form",{onSubmit:b,className:"mt-4",children:(0,a.jsx)(w.Z,{type:"submit",className:"w-full lowercase",size:"sm",loading:u,disabled:!(null==o?void 0:o.filter(e=>e.isSelected).length),children:"Pay with Stripe"})}),(0,a.jsx)("div",{className:"mt-4",children:(0,a.jsx)(P.Elements,{stripe:E(),children:(0,a.jsx)(z,{amount:Number(x)+0,disabled:!(null==o?void 0:o.filter(e=>e.isSelected).length)})})}),(0,a.jsx)("form",{onSubmit:j,className:"mt-4",children:(0,a.jsx)(w.Z,{type:"submit",className:"w-full lowercase",size:"sm",loading:p,disabled:!(null==o?void 0:o.filter(e=>e.isSelected).length),children:"Pay with Paypal"})})]}):""]})};var F=l(7598);let W=e=>{let{address:t,onUpdateUserEmail:l,step:s}=e,[i,r]=(0,f.useState)("edit"),{register:n,handleSubmit:d,formState:{errors:o}}=(0,N.cI)();(0,f.useEffect)(()=>{var e,l,s,a,i;t&&(null==t?void 0:null===(e=t.name)||void 0===e?void 0:e.length)>0&&(null==t?void 0:null===(l=t.phone)||void 0===l?void 0:l.length)>0&&(null==t?void 0:null===(s=t.address)||void 0===s?void 0:s.length)>0&&(null==t?void 0:null===(a=t.zip)||void 0===a?void 0:a.length)>0&&(null==t?void 0:null===(i=t.city)||void 0===i?void 0:i.length)>0?r("show"):r("edit")},[t]);let c=e=>{l({address:e}),r("show")};return(0,a.jsxs)("div",{className:"p-4 bg-white border border-primary-light md:p-8 md:py-10 rounded-2xl",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("h5",{className:"lowercase",children:"Shipping Address*"}),"edit"!==i?(0,a.jsx)("p",{className:"font-normal cursor-pointer",onClick:()=>r("edit"),children:"edit"}):""]}),s>=2?"edit"===i?(0,a.jsxs)("form",{onSubmit:d(c),className:"mt-8",children:[(0,a.jsxs)("section",{className:"flex flex-wrap -m-2",children:[(0,a.jsx)(F.Zw,{placeholder:"your name",defaultValue:null==t?void 0:t.name,...n("name",{required:!0}),wrapperClassName:"w-1/2 p-2 text-center mb-6",imgWrapperClassName:"w-full h-[60px] mt-[-21px]",style:{paddingLeft:"10px",paddingRight:"5px"}}),(0,a.jsx)(F.Zw,{placeholder:"your phone",defaultValue:null==t?void 0:t.phone,...n("phone",{required:!0}),wrapperClassName:"w-1/2 p-2 text-center mb-6",imgWrapperClassName:"w-full h-[60px] mt-[-21px]",style:{paddingLeft:"10px",paddingRight:"5px"}})]}),(0,a.jsx)("div",{className:"m-0",children:(0,a.jsx)(F.Zw,{placeholder:"address",defaultValue:null==t?void 0:t.address,...n("address",{required:!0}),wrapperClassName:"text-center mb-9",imgWrapperClassName:"w-full h-[60px] mt-[-21px]",style:{paddingLeft:"10px",paddingRight:"5px"}})}),(0,a.jsxs)("section",{className:"flex flex-wrap -m-2",children:[(0,a.jsx)(F.Zw,{placeholder:"zip code",defaultValue:null==t?void 0:t.zip,...n("zip",{required:!0}),wrapperClassName:"w-1/2 p-2 mb-4 text-center",imgWrapperClassName:"w-full h-[60px] mt-[-21px]",style:{paddingLeft:"10px",paddingRight:"5px"}}),(0,a.jsx)(F.Zw,{placeholder:"city",defaultValue:null==t?void 0:t.city,...n("city",{required:!0}),wrapperClassName:"w-1/2 p-2 mb-4 text-center",imgWrapperClassName:"w-full h-[60px] mt-[-21px]",style:{paddingLeft:"10px",paddingRight:"5px"}})]}),(0,a.jsxs)("div",{className:"items-center mb-6 font-normal",children:[(0,a.jsx)("input",{type:"checkbox",className:"w-5 h-5 mr-2",style:{accentColor:"#705D36"},...n("tAndC",{required:"please accept terms and conditions to continue."})}),"I have read and agree to all of the",(0,a.jsx)("span",{children:(0,a.jsx)(b(),{href:"/term-and-condition",target:"_blank",className:"mx-1 text-primary-pink",children:"terms and conditions"})}),"in the agreement shown above. Rest assured, your personal information is never displayed on Darash Ahava Foundation and Brushstrokes of Emotion anywhere, it is used solely for signing the disclaimer.",(null==o?void 0:o.tAndC)?(0,a.jsx)("p",{className:"text-sm text-red-500 md:text-lg",children:o.tAndC.message}):""]}),(0,a.jsx)(w.Z,{type:"submit",className:"w-full lowercase",size:"sm",children:"Continue"})]}):(0,a.jsxs)("p",{className:"mt-6 font-normal lowercase",children:[null==t?void 0:t.name,(0,a.jsx)("br",{}),null==t?void 0:t.address,(0,a.jsx)("br",{}),null==t?void 0:t.city,(0,a.jsx)("br",{}),null==t?void 0:t.zip]}):""]})},A=e=>{var t;let{mutate:l}=e,[s,i]=(0,f.useState)({}),[r,n]=(0,f.useState)(1),{data:o}=(0,y.useQuery)("api/customer/profile",g.TW),{cart:c}=(0,d.i)(),u=(0,v.useRouter)();(0,f.useEffect)(()=>{(null==s?void 0:s.email)?(null==s?void 0:s.address)?(null==s?void 0:s.payment)||n(3):n(2):n(1)},[s]),(0,f.useEffect)(()=>{var e,t,s,a,i,r;let n=(null==u?void 0:null===(e=u.query)||void 0===e?void 0:e.session_id)||(null===(t=window.location.href)||void 0===t?void 0:t.split("session_id=")[1]);if(console.log("checkout data",{cart:c,session_id:n}),n&&(null==c?void 0:c.length)>0)try{let d=JSON.parse(window.localStorage.getItem("userData"));if(d){console.log("stripe payment check -> userData",d);let m={fname:(null==d?void 0:null===(s=d.address)||void 0===s?void 0:s.name)||"",email:(null==d?void 0:d.email)||"",phone:(null==d?void 0:null===(a=d.address)||void 0===a?void 0:a.phone)||"",address1:(null==d?void 0:null===(i=d.address)||void 0===i?void 0:i.address)||"",city:(null==d?void 0:null===(r=d.address)||void 0===r?void 0:r.city)||"",state:(null==o?void 0:o.state)||"",country:(null==o?void 0:o.country)||"",postcode:null==d?void 0:d.address.zip,payment_status:2,payment_method:"Stripe",payment_id:n,orderedItems:c.filter(e=>e.isSelected).map(e=>({product_model_id:e.id,qty:e.quantity,attribute_value_id:e.variant.attribute_value_id}))};console.log("stripe payment check -> mappedData",m),l(m)}else console.log("stripe payment check -> userData",d)}catch(p){console.log("stripe payment check -> err",p.messaage)}},[null==u?void 0:null===(t=u.query)||void 0===t?void 0:t.session_id,c]),(0,f.useEffect)(()=>{o&&i({email:null==o?void 0:o.email,address:{name:null==o?void 0:o.name,address:null==o?void 0:o.address1,zip:null==o?void 0:o.postcode,city:null==o?void 0:o.city,phone:null==o?void 0:o.phone_no}})},[o]);let m=e=>{i({...s,...e})};return(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsx)(S,{onUpdateUserEmail:m,email:null==s?void 0:s.email})}),(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsx)(W,{onUpdateUserEmail:m,address:null==s?void 0:s.address,step:r})}),(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsx)(D,{onUpdateUserEmail:m,data:s,step:r})})]})},U=()=>{var e;let{cart:t,resetCart:l}=(0,d.i)(),s=(0,v.useRouter)(),[r,n]=(0,f.useState)(!1),{mutate:o,isLoading:c}=(0,y.useMutation)(C.J2,{onSuccess(){k.Am.success("order placed successfully!!",{position:"top-right"}),l(),n(!0),s.replace("/")},onError(e){e&&(k.Am.error(null==e?void 0:e.message,{position:"top-right"}),n(!1))}});return(0,f.useEffect)(()=>{var e,t;n(!0);let l=(null==s?void 0:null===(e=s.query)||void 0===e?void 0:e.session_id)||(null===(t=window.location.href)||void 0===t?void 0:t.split("session_id=")[1]);l||n(!1)},[null==s?void 0:null===(e=s.query)||void 0===e?void 0:e.session_id]),(0,a.jsxs)(i.Z,{children:[(c||r)&&(0,a.jsx)("div",{className:"fixed top-0 left-0 h-full w-full flex items-center justify-center bg-[#00000090] text-white z-50",children:(0,a.jsx)("picture",{children:(0,a.jsx)("img",{src:"/img/spinner.gif",alt:"loading",className:"w-16 h-16"})})}),(0,a.jsx)("div",{className:"py-16 bg-secondary-bg",children:(0,a.jsx)("div",{className:"container px-2 mx-auto md:px-4",children:(0,a.jsx)("div",{className:"max-w-6xl mx-auto ",children:(0,a.jsxs)("div",{className:"flex flex-wrap -m-2 md:-m-4 lg:-m-8",children:[(0,a.jsx)("div",{className:"order-2 w-full p-2 lg:w-1/2 md:p-4 lg:p-8 lg:order-1",children:(0,a.jsx)(x,{data:null==t?void 0:t.filter(e=>e.isSelected)})}),(0,a.jsx)("div",{className:"order-1 w-full p-2 lg:w-1/2 md:p-4 lg:p-8 lg:order-2",children:(0,a.jsx)(A,{mutate:o})})]})})})})]})};var Z=U},7703:function(e,t,l){"use strict";l.d(t,{Ao:function(){return m},Hy:function(){return d},NG:function(){return o},S$:function(){return c},TW:function(){return n},gM:function(){return r},h1:function(){return u},jW:function(){return i}});var s=l(9361),a=l(5952);let i=async e=>{let{data:t}=await a.K.post("api/customer/auth/login",e);return t},r=async e=>{let{data:t}=await a.K.post("api/customer/auth/register",e);return t},n=async()=>{let{data:e}=await a.K.get("api/customer/profile",(0,s.wU)());return e.data.customer},d=async e=>{let{data:t}=await a.K.put("api/customer/edit-profile",e,(0,s.wU)());return t},o=async e=>{let{data:t}=await a.K.patch("api/customer/change-password",e,(0,s.wU)());return t},c=async e=>{let{data:t}=await a.K.post("api/customer/auth/forgot-password",e);return t},u=async e=>{let{data:t}=await a.K.post("api/customer/auth/reset-password",e);return t},m=async()=>{let{data:e}=await a.K.get("api/v1/get-order",(0,s.wU)());return e}}},function(e){e.O(0,[976,948,61,312,890,220,774,888,179],function(){return e(e.s=7250)}),_N_E=e.O()}]);